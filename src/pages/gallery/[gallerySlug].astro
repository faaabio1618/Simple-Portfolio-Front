---
const {gallerySlug} = Astro.params;
export const prerender = false;
import Layout from '../../layouts/Layout.astro';
import {retrieveGallery, retrieveHeader, retrievePhotographer} from '../../lib/strapi';
const header = await retrieveHeader();
const photographer = await retrievePhotographer();
const gallery_ = await retrieveGallery(gallerySlug);
---

<Layout title="Portfolio" header={header} photographer={photographer}>

    {!gallery_ &&
            <div class="text-center text-2xl font-bold">Gallery not found
                <figure class="relative w-full h-auto break-inside-avoid">
                    <div class="w-full"
                         style={`aspect-ratio: 16 / 9`}>
                        <img
                                src="/assets/gallery_not_found.jpg"
                                alt="Gallery not found"
                                class="w-full h-full object-cover"
                        />
                    </div>
                </figure>
            </div>
    }
    {gallery_ &&
            <div class="columns-1 md:columns-2 lg:columns-2 gap-10 p-4 space-y-4">
                {gallery_.Pictures.map((picture) => {
                    const ifVertical =
                            <>
                                <a href="#"
                                   class="block mb-16 overflow-hidden hover:shadow-xl transition-shadow">
                                    <figure class="relative w-full h-auto break-inside-avoid">
                                        <div class="w-full"
                                             style={`aspect-ratio: ${picture.width} / ${picture.height}`}>
                                            <img
                                                    src={picture.url}
                                                    alt={picture.alternativeText}
                                                    class="w-full h-full object-cover"
                                            />
                                        </div>
                                        <div class="absolute inset-0 flex items-end p-4 opacity-0 opacity-20 hover:opacity-40 bg-black transition-opacity">
                                        </div>
                                    </figure>
                                </a>
                            </>;
                    const ifHorizontal =
                            <>
                                <a href="#"
                                   class="block  mb-16 overflow-hidden hover:shadow-xl transition-shadow">
                                    <figure class="relative w-full h-auto break-inside-avoid">
                                        <div class="w-full"
                                             style={`aspect-ratio: ${picture.width} / ${picture.height}`}>
                                            <img
                                                    src={picture.url}
                                                    alt={picture.alternativeText}
                                                    class="w-full h-full object-cover"
                                            />
                                        </div>
                                        <div class="absolute inset-0 flex items-end p-4 opacity-0 opacity-20 hover:opacity-40 bg-black transition-opacity">
                                        </div>
                                    </figure>
                                </a>
                            </>

                    const ratio = picture.width / picture.height;
                    return (
                            <>
                                {ratio > 1 ? ifHorizontal : ifVertical}
                            </>
                    )

                })}
            </div>
    }
</Layout>