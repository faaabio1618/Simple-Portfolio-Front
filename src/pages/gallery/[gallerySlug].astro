---
const {gallerySlug} = Astro.params;
import type Gallery from "../../interfaces/Gallery";
export const prerender = false;
import Layout from '../../layouts/Layout.astro';
import fetchApi, {retrievePortfolio} from '../../lib/strapi';
import type HeaderType from "../../interfaces/Header";
import type Photographer from "../../interfaces/Photographer";
const header = await fetchApi<HeaderType>({
    endpoint: '/header?populate=*',
    wrappedByKey: "data",
}) as HeaderType;
const photographer = await fetchApi({
    endpoint: '/photographer?populate=*',
    wrappedByKey: "data",
}) as Photographer;
const gallery_ = (await fetchApi<Gallery[] | null>({
    endpoint: `/galleries?filters[Slug][$eq]=${gallerySlug}&populate=*`,
    wrappedByKey: "data",
}) as Gallery[])[0];
---

<Layout title="Portfolio" header={header} photographer={photographer}>
    <div class="columns-1 md:columns-2 lg:columns-2 gap-10 p-4 space-y-4">
        {gallery_.Pictures.map((picture) => {
            const ifVertical =
                    <>
                        <a href="#"
                           class="block mb-16 overflow-hidden hover:shadow-xl transition-shadow">
                            <figure class="relative w-full h-auto break-inside-avoid">
                                <div class="w-full"
                                     style={`aspect-ratio: ${picture.width} / ${picture.height}`}>
                                    <img
                                            src={picture.url}
                                            alt={picture.alternativeText}
                                            class="w-full h-full object-cover"
                                    />
                                </div>
                                <div class="absolute inset-0 flex items-end p-4 opacity-0 opacity-20 hover:opacity-40 bg-black transition-opacity">
                                </div>
                            </figure>
                        </a>
                    </>;
            const ifHorizontal =
                    <>
                        <a href="#"
                           class="block  mb-16 overflow-hidden hover:shadow-xl transition-shadow">
                            <figure class="relative w-full h-auto break-inside-avoid">
                                <div class="w-full"
                                     style={`aspect-ratio: ${picture.width} / ${picture.height}`}>
                                    <img
                                            src={picture.url}
                                            alt={picture.alternativeText}
                                            class="w-full h-full object-cover"
                                    />
                                </div>
                                <div class="absolute inset-0 flex items-end p-4 opacity-0 opacity-20 hover:opacity-40 bg-black transition-opacity">
                                </div>
                            </figure>
                        </a>
                    </>

            const ratio = picture.width / picture.height;
            return (
                    <>
                        {ratio > 1 ? ifHorizontal : ifVertical}
                    </>
            )

        })}
    </div>
</Layout>